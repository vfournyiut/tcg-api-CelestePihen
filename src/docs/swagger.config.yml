openapi: 3.0.0
info:
  title: TCG Pok√©mon API
  description: |
    API REST pour g√©rer une application de cartes √† collectionner Pok√©mon.
    
    ## Fonctionnalit√©s
    - üîê Authentification JWT (inscription, connexion)
    - üé¥ Gestion des cartes Pok√©mon
    - üìö Gestion des decks personnalis√©s (10 cartes par deck)
    
    ## Authentification
    Pour acc√©der aux routes prot√©g√©es, utilisez le bouton **Authorize** et entrez votre token JWT au format: `Bearer <votre_token>`
  version: 1.0.0
  contact:
    name: API Support
    email: support@tcg-api.com

servers:
  - url: http://localhost:{port}/api
    description: Serveur de d√©veloppement local
    variables:
      port:
        default: '3001'
        description: Port du serveur

tags:
  - name: Auth
    description: Endpoints d'authentification (inscription, connexion)
  - name: Cards
    description: Endpoints de gestion des cartes Pok√©mon
  - name: Decks
    description: Endpoints de gestion des decks personnalis√©s

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Authentification via token JWT.
        Entrez votre token (sans le pr√©fixe "Bearer")

  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          description: ID unique de l'utilisateur
          example: 1
        username:
          type: string
          description: Nom d'utilisateur unique
          example: "ash_ketchum"
        email:
          type: string
          format: email
          description: Adresse email unique
          example: "ash@pokemon.com"
      required:
        - id
        - username
        - email

    Card:
      type: object
      properties:
        id:
          type: integer
          description: ID unique de la carte
          example: 1
        name:
          type: string
          description: Nom du Pok√©mon
          example: "Pikachu"
        hp:
          type: integer
          description: Points de vie
          example: 60
          minimum: 1
        attack:
          type: integer
          description: Points d'attaque
          example: 90
          minimum: 1
        type:
          type: string
          enum:
            - Normal
            - Fire
            - Water
            - Electric
            - Grass
            - Ice
            - Fighting
            - Poison
            - Ground
            - Flying
            - Psychic
            - Bug
            - Rock
            - Ghost
            - Dragon
            - Dark
            - Steel
            - Fairy
          description: Type du Pok√©mon
          example: "Electric"
        pokedexNumber:
          type: integer
          description: Num√©ro national du Pok√©dex
          example: 25
          minimum: 1
        imgUrl:
          type: string
          format: uri
          nullable: true
          description: URL de l'image de la carte
          example: "https://example.com/pikachu.png"
      required:
        - id
        - name
        - hp
        - attack
        - type
        - pokedexNumber

    Deck:
      type: object
      properties:
        id:
          type: integer
          description: ID unique du deck
          example: 1
        name:
          type: string
          description: Nom du deck
          example: "Mon √©quipe √©lectrique"
        userId:
          type: integer
          description: ID du propri√©taire du deck
          example: 1
        deckCards:
          type: array
          description: Liste des associations carte-deck
          items:
            $ref: '#/components/schemas/DeckCard'
      required:
        - id
        - name
        - userId

    DeckCard:
      type: object
      description: Association entre un deck et une carte
      properties:
        id:
          type: integer
          description: ID unique de l'association
          example: 1
        deckId:
          type: integer
          description: ID du deck
          example: 1
        cardId:
          type: integer
          description: ID de la carte
          example: 25

    Error:
      type: object
      properties:
        error:
          type: string
          description: Message d'erreur
          example: "Erreur serveur"
      required:
        - error

    SignUpRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Adresse email de l'utilisateur
          example: "ash@pokemon.com"
        username:
          type: string
          description: Nom d'utilisateur (unique)
          minLength: 3
          example: "ash_ketchum"
        password:
          type: string
          format: password
          description: Mot de passe (sera hash√©)
          minLength: 6
          example: "pikachu123"
      required:
        - email
        - username
        - password

    SignInRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Adresse email
          example: "ash@pokemon.com"
        password:
          type: string
          format: password
          description: Mot de passe
          example: "pikachu123"
      required:
        - email
        - password

    AuthResponse:
      type: object
      properties:
        message:
          type: string
          example: "Connexion r√©ussie"
        token:
          type: string
          description: Token JWT valide
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        user:
          $ref: '#/components/schemas/User'
      required:
        - message
        - token
        - user

    SignUpResponse:
      type: object
      properties:
        message:
          type: string
          example: "Utilisateur cr√©√©"
        token:
          type: string
          description: Token JWT valide 7 jours
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        userCreated:
          $ref: '#/components/schemas/User'
      required:
        - message
        - token
        - userCreated

    CreateDeckRequest:
      type: object
      properties:
        name:
          type: string
          description: Nom du deck
          minLength: 1
          example: "Mon √©quipe √©lectrique"
        cards:
          type: array
          description: Liste de 10 num√©ros Pok√©dex
          items:
            type: integer
            minimum: 1
          minItems: 10
          maxItems: 10
          example: [25, 26, 135, 81, 82, 100, 101, 172, 239, 466]
      required:
        - name
        - cards

    UpdateDeckRequest:
      type: object
      properties:
        name:
          type: string
          description: Nouveau nom du deck
          minLength: 1
          example: "√âquipe √©lectrique v2"
        cards:
          type: array
          description: Nouvelle liste de 10 num√©ros Pok√©dex
          items:
            type: integer
            minimum: 1
          minItems: 10
          maxItems: 10
          example: [25, 26, 135, 81, 82, 100, 101, 172, 239, 466]
      required:
        - name
        - cards

    SuccessMessage:
      type: object
      properties:
        message:
          type: string
          example: "Op√©ration r√©ussie"
      required:
        - message

    CardsResponse:
      type: object
      properties:
        cards:
          type: array
          items:
            $ref: '#/components/schemas/Card'
      required:
        - cards

  responses:
    UnauthorizedError:
      description: Token manquant, invalide ou expir√©
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            missingToken:
              value:
                error: "Token manquant"
            invalidToken:
              value:
                error: "Token invalide ou expir√©"

    ForbiddenError:
      description: Acc√®s refus√© (ressource ne vous appartient pas)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Ce deck n'appartient pas √† l'utilisateur"

    NotFoundError:
      description: Ressource non trouv√©e
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Deck invalide"

    BadRequestError:
      description: Donn√©es invalides
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            invalidData:
              value:
                error: "Donn√©es invalides"
            invalidCards:
              value:
                error: "Cartes invalides"

    ConflictError:
      description: Conflit (ressource existe d√©j√†)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Email ou username invalide"

    ServerError:
      description: Erreur interne du serveur
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Erreur serveur"
